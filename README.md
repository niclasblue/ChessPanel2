C#编程小品之一（棋盘寻路问题）
===

# 1. 问题表述

今天下午，在知乎上看到了一个有意思的提问：
[在2n个顺序摆放的盒子中填充n个白球和n个黑球，要求任取前m个盒子，其中黑球数目不少于白球？](https://www.zhihu.com/question/277118644)

> ## 在2n个顺序摆放的盒子中填充n个白球和n个黑球，要求任取前m个盒子，其中黑球数目不少于白球？

> 举例，例如两个盒子，一个黑一个白，则只有"黑白"这一种摆法。

> 四个盒子，两个黑两个白，则有"黑黑白白"，"黑白黑白"，两种摆法符合要求。

> 六个盒子，三黑三白，则有"黑黑黑白白白"，"黑黑白黑白白"，"黑黑白白黑白"，"黑白黑黑白白"，"黑白黑白黑白"，共五种符合要求。

> 请问对于一般情况，通解应该是什么？

# 2. 解决思路

其中一个答案给了一个很好的思路:

> 高中遇见过这个题。这个题可以转化成一个路径问题。可以画一个n×n的网格，排序问题可以转化成从左下顶点，走到右上顶点一共有多少条路径。(向右走等价放黑，向上走等价放白)(只能向右走或向上走)满足黑球数量大于等于白球，所以路径必须在下半个等腰三角形中。。。图中阴影部分


![网格图片示例](v2-261f046a9d3dd8780d0ec79dd3c6c9e5_r.jpg)

作者：咸鱼嘿
链接：https://www.zhihu.com/question/277118644/answer/391462622
来源：知乎

我感觉这个办法可以用C#来实现，下面我先说一下思路：

1. 创建棋盘节点对象（Node）

2. 创建棋子对象（cell）

3. 新建一个由n*n个节点组成的棋盘，并初始化

4. 初始化第一个棋子，把它放在棋盘左下角节点的位置

5. 按照行棋规则，棋子开始移动（**重点：棋子在移动之前，先要判断有多少条合法路径，如果多于一条，就先复制自己来走每一条路。**）

6. 重复第5步，直到棋子无法移动，则游戏结束

7. 在棋盘终点查看到达终点的棋子数量，该数量就是问题的解

# 3. 实现方法

## 1. 创建棋盘节点对象（node）

node对象包含以下2个属性：

坐标（可直接设置为整数型的x坐标和y坐标，但为以后扩展方便，如改为3维坐标，还是设置为坐标枚举比较好）

该节点所包含的所有棋子（一个棋子对象的集合）

## 2. 创建棋子对象（cell）

cell对象包含以下2个属性：

序列号（从0号开始）

所处的节点坐标

包含以下2个方法：

分裂：分裂一个新的cell对象，序列号为当前棋子序列号+1

移动到（包含一个“规则（rule）”参数和“坐标”参数）：按照相应规则移动到相应坐标

## 3. 新建棋盘

先由用户输入棋盘大小n；

从（0，0）开始到（n, n）创建节点，节点的坐标范围要求x >= y，最终设置好后节点就是图中的阴影范围；

设置棋子移动规则为只能向上或者向右移动；

## 4. 初始化棋子

创建0号棋子，并将其坐标设置为（0, 0）

## 5. 移动棋子

### 1） 判断棋子的可行通路有几条：

按照规则，棋子当前坐标为（x, y），则只能移动到（x+1，y）或者（x，y+1），如果这两个坐标都是合法坐标（在阴影范围之内），则说明有2条可行通路；

如果只有一个坐标合法，则说明只有1条可行通路；

如果没有坐标合法，则说明棋子已到达终点。

### 2） 如果有2条路：

则调用棋子的分裂方法，将棋子分裂为2个，分裂出的新棋子走到（x+1, y）位置，原棋子走到（x，y+1）位置。

### 3） 如果只有1条路：

棋子移动到下一个合法坐标。

### 4） 没有合法坐标：

棋子已到达终点，程序转到下一个棋子（假如存在的话）的位置，开始移动下一个棋子；

如果没有下一个棋子，棋子就移动完成。

## 6. 统计棋子数量

移动程序结束后，在棋盘的终点节点统计棋子的数量，并将数量返回给用户，程序结束。













